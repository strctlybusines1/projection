
======================================================================
MDN V4 - MONEYPUCK EXTENDED VERSION
======================================================================

Loading data...
Precomputing rolling features...
Precomputing exponentially-weighted FPTS...
Precomputing season-to-date features...
Precomputing TOI trend feature...
Computing league baseline stats...
Loading MoneyPuck skaters...
Loading MoneyPuck teams...
  5v5 skaters: 5578
  5on4 skaters: 5578
  Teams 5v5: 191
Boxscore rows: 32687

Engineering features...
Computing opponent FPTS allowed...
Adding MoneyPuck features...
  Matching 32687 boxscore rows...
    Processing row 0/32687...
    Processing row 5000/32687...
    Processing row 10000/32687...
    Processing row 15000/32687...
    Processing row 20000/32687...
    Processing row 25000/32687...
    Processing row 30000/32687...
  Feature coverage:
    xg_per_game_5v5: 100.0%
    hd_xg_per_game_5v5: 100.0%
    shots_per_game_5v5: 100.0%
    onice_xgf_pct_5v5: 100.0%
    gamescore_per_game: 100.0%
    ozone_start_pct: 100.0%
    pp_xg_per_game: 100.0%
    pp_points_per_game: 100.0%
    pp_icetime_per_game: 100.0%
    opp_xga_per_game: 100.0%
    opp_hdxga_per_game: 100.0%
    opp_xgf_pct: 100.0%
Adding regression-shrunk season averages...


======================================================================
RUNNING WALK-FORWARD BACKTEST
======================================================================
Backtest period: 2025-11-07 to 2026-02-05

Retraining on 8136 samples (test date: 2025-11-07)
    Epoch 10/30, Loss: -3.318584
    Epoch 20/30, Loss: -3.324311
    Epoch 30/30, Loss: -3.326630
  2025-11-07: 144 games, MAE=5.4448
  2025-11-08: 468 games, MAE=5.9172
  2025-11-09: 288 games, MAE=6.1986
  2025-11-10: 144 games, MAE=6.4743
  2025-11-11: 324 games, MAE=5.7692
  2025-11-12: 144 games, MAE=6.1224
  2025-11-13: 360 games, MAE=6.4249
  2025-11-14: 144 games, MAE=5.7762
  2025-11-15: 468 games, MAE=5.6759
  2025-11-16: 180 games, MAE=5.5765
  2025-11-17: 216 games, MAE=5.9485
  2025-11-18: 288 games, MAE=5.6711
  2025-11-19: 144 games, MAE=6.7867
  2025-11-20: 432 games, MAE=5.9963
Retraining on 11880 samples (test date: 2025-11-21)
    Epoch 10/30, Loss: -3.318425
    Epoch 20/30, Loss: -3.321958
    Epoch 30/30, Loss: -3.322721
  2025-11-21: 144 games, MAE=4.6719
  2025-11-22: 432 games, MAE=4.5390
  2025-11-23: 216 games, MAE=4.9324
  2025-11-24: 252 games, MAE=5.0830
  2025-11-25: 36 games, MAE=5.9891
  2025-11-26: 540 games, MAE=4.7645
  2025-11-28: 540 games, MAE=4.8226
  2025-11-29: 396 games, MAE=4.6247
  2025-11-30: 144 games, MAE=4.7322
  2025-12-01: 180 games, MAE=4.0576
  2025-12-02: 360 games, MAE=5.0358
  2025-12-03: 180 games, MAE=5.6538
  2025-12-04: 360 games, MAE=4.5984
Retraining on 15660 samples (test date: 2025-12-05)
    Epoch 10/30, Loss: -3.301485
    Epoch 20/30, Loss: -3.312453
    Epoch 30/30, Loss: -3.314929
  2025-12-05: 180 games, MAE=4.9423
  2025-12-06: 432 games, MAE=5.4332
  2025-12-07: 288 games, MAE=5.7661
  2025-12-08: 180 games, MAE=5.4043
  2025-12-09: 360 games, MAE=6.0192
  2025-12-10: 144 games, MAE=5.5714
  2025-12-11: 468 games, MAE=6.3266
  2025-12-12: 72 games, MAE=4.8669
  2025-12-13: 468 games, MAE=5.4632
  2025-12-14: 216 games, MAE=5.2154
  2025-12-15: 180 games, MAE=5.5302
  2025-12-16: 360 games, MAE=5.6255
  2025-12-17: 180 games, MAE=4.7445
  2025-12-18: 359 games, MAE=5.2636
Retraining on 19547 samples (test date: 2025-12-19)
    Epoch 10/30, Loss: -3.325924
    Epoch 20/30, Loss: -3.329680
    Epoch 30/30, Loss: -3.328060
  2025-12-19: 180 games, MAE=4.4952
  2025-12-20: 468 games, MAE=4.8440
  2025-12-21: 324 games, MAE=4.7586
  2025-12-22: 144 games, MAE=4.2567
  2025-12-23: 468 games, MAE=4.5525
  2025-12-27: 468 games, MAE=4.9361
  2025-12-28: 180 games, MAE=5.0142
  2025-12-29: 396 games, MAE=4.3176
  2025-12-30: 180 games, MAE=4.2784
  2025-12-31: 360 games, MAE=4.5116
  2026-01-01: 288 games, MAE=4.9773
Retraining on 23003 samples (test date: 2026-01-02)
    Epoch 10/30, Loss: -3.337895
    Epoch 20/30, Loss: -3.341679
    Epoch 30/30, Loss: -3.341365
  2026-01-02: 144 games, MAE=4.7636
  2026-01-03: 468 games, MAE=4.4468
  2026-01-04: 180 games, MAE=4.3401
  2026-01-05: 180 games, MAE=4.1698
  2026-01-06: 360 games, MAE=4.7130
  2026-01-07: 180 games, MAE=4.9095
  2026-01-08: 432 games, MAE=4.4560
  2026-01-09: 108 games, MAE=4.5070
  2026-01-10: 504 games, MAE=4.5432
  2026-01-11: 180 games, MAE=4.2091
  2026-01-12: 324 games, MAE=4.3742
  2026-01-13: 360 games, MAE=4.5249
  2026-01-14: 144 games, MAE=5.0140
  2026-01-15: 360 games, MAE=4.0520
Retraining on 26927 samples (test date: 2026-01-16)
    Epoch 10/30, Loss: -3.327616
    Epoch 20/30, Loss: -3.328810
    Epoch 30/30, Loss: -3.331569
  2026-01-16: 180 games, MAE=4.6351
  2026-01-17: 468 games, MAE=4.4988
  2026-01-18: 108 games, MAE=4.3226
  2026-01-19: 360 games, MAE=4.6052
  2026-01-20: 288 games, MAE=4.8058
  2026-01-21: 216 games, MAE=4.3856
  2026-01-22: 288 games, MAE=4.7765
  2026-01-23: 288 games, MAE=4.3677
  2026-01-24: 324 games, MAE=4.5612
  2026-01-25: 216 games, MAE=4.9373
  2026-01-26: 144 games, MAE=4.6732
  2026-01-27: 360 games, MAE=4.4850
  2026-01-28: 108 games, MAE=4.9529
  2026-01-29: 540 games, MAE=4.9166
Retraining on 30815 samples (test date: 2026-01-30)
    Epoch 10/30, Loss: -3.337081
    Epoch 20/30, Loss: -3.343286
    Epoch 30/30, Loss: -3.342084
  2026-01-30: 36 games, MAE=5.1485
  2026-01-31: 504 games, MAE=4.2002
  2026-02-01: 108 games, MAE=4.0931
  2026-02-02: 360 games, MAE=4.7400
  2026-02-03: 252 games, MAE=4.4176
  2026-02-04: 360 games, MAE=4.6869
  2026-02-05: 252 games, MAE=4.1727

======================================================================
BACKTEST SUMMARY
======================================================================
Total predictions: 24551
Overall MAE: 4.9710
Overall RMSE: 6.7548

Results saved to /sessions/youthful-funny-faraday/mnt/Code/projection/data/mdn_v4_backtest_results.csv

======================================================================
COMPARISON WITH V3 (MAE 4.091)
======================================================================
V3 MAE: 4.091
V4 MAE: 4.9710
Improvement: -0.8800 (-21.51%)

