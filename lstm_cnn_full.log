Using device: cpu
Loading data...
Loaded 220062 historical rows from seasons 2020 to 2024
Loaded 32687 current season rows
Loaded 220062 historical rows

================================================================================
WALK-FORWARD BACKTEST: LSTM-CNN vs MDN v3 vs Kalman
================================================================================

Retrain cycle 1: Training date = 2025-11-07
  Creating sequences...
Traceback (most recent call last):
  File "/sessions/youthful-funny-faraday/mnt/Code/projection/lstm_cnn.py", line 723, in <module>
    main()
  File "/sessions/youthful-funny-faraday/mnt/Code/projection/lstm_cnn.py", line 711, in main
    results = run_walk_forward_backtest(df_current, df_historical)
  File "/sessions/youthful-funny-faraday/mnt/Code/projection/lstm_cnn.py", line 514, in run_walk_forward_backtest
    sequences = create_all_sequences(df_train, min_games=10)
  File "/sessions/youthful-funny-faraday/mnt/Code/projection/lstm_cnn.py", line 333, in create_all_sequences
    player_sequences = create_sequences(df_player, sequence_length=SEQUENCE_LENGTH)
  File "/sessions/youthful-funny-faraday/mnt/Code/projection/lstm_cnn.py", line 294, in create_sequences
    home_road = 1.0 if pred_row.get('home_road', '').upper() == 'H' else 0.0
AttributeError: 'float' object has no attribute 'upper'
